# 目的
- Chainerに関するありったけの知識を共有
  - 生兵法です
  - for Chainerにあまり触った事がない人
- 先日バージョンアップされ、以前と異なる書き方ができるようになったので、その変更点を知ってもらう
  - for Chainerに最近触ってない人
- RNNを少し説明
  - for 興味ある方

# Chainerとは?
- Preferred Networksが開発したニューラルネットワークを実装するためのPythonライブラリ
  - 言語Python
  - Ubuntuが推奨されている
- Preferred Networks : IoTにフォーカスしたリアルタイム機械学習技術のビジネス活用を目的とした会社
  - 最近DeNAと合弁会社を設立したことで話題に　http://jp.techcrunch.com/2016/07/14/dena-pfn-ai/
- Chainerの特徴は下記のとおり（HPより抜粋）
  - 高速: CUDAをサポートし、GPUを利用した高速な計算が可能
  - 柔軟: 柔軟な記法により、畳み込み、リカレントなど、様々なタイプのニューラルネットを実装可能
  - 直観的: ネットワーク構成を直観的に記述できる
  - TensorBoardみたいな可視化ツールはない
  - Caffeのmodel zooが使える
- インストールは 「pip install chainer」で行える
  - ただし、インストールが簡単というのは嘘（Windowsに導入する場合だけかもしれませんが・・・）
- CPUでは遅い（TensorFlowより遅い）が、GPUを利用すると早い
  - http://nonbiri-tereka.hatenablog.com/entry/2015/12/16/003512
- ライセンスはMIT（Expat） License
- 参考資料
  - http://www.slideshare.net/unnonouno/chainer-59664785
  - http://www.slideshare.net/ryokuta/chainer-59180103
  - P23の比較が分かりやすい

# Demo
## 1.Introduction
- Chaienrの概要を図示
  - http://atrg.jp/ja/index.php?plugin=attach&pcmd=open&file=20151225-ATTA-oono.pdf&refer=ATTA2015
  - P27～38
- 変数：Variable
- 層：Link
- 計算グラフ：Chian
- 最適化アルゴリズム：Optimizer
- 入出力はテンソルとして扱う
- Variableオブジェクト：計算グラフのデータノード、Numpy or Cupyの多次元配列を保持する。
- Functionオブジェクト：計算グラフの（パラメータを持たない）演算ノード、Variableを受け取り、Variableを出力する
- Linkオブジェクト：Optimizerの最適化の対象
- Cain：Linkをまとめる
- Optimizer：勾配を用いてパラメータ最適化する　SGD , MomentumSGD , AdaGrad , RMSprop , Adam など
  - Linkを引数に渡してupdateすればよい

## GitHub上のChainer/masterにおけるexample集
- https://github.com/pfnet/chainer/tree/master/examples
- imagenet
- mnist
- modelzoo
- ptb → RNNを使ってPen Tree Bankを学習する
- sentiment
- vae → Variational AutoEncorder
- word2vec : C-bowとSkip-gram　の実装 

## 2.Mnist Sample
### def __call__ 
伝播の処理　tensorflowでいうところの　tf.nn.sigmoid　？
ChainerではForward処理を記述しておけば、逆伝播は勝手に処理してくれる

### L.Classifier
分類器を作成する際の「損失関数」「精度評価」をするための
Classifierがデフォルトで入っている

### MNIST Dataset
- TensorFlowでTutorial等で使うデータとして提供されている
  - dataset of handwrittend digits
  - 60,000 examples for training
  - 10,000 examples for testing
  - 28✕ 28 サイズ
  - values from 0 to 1

## 3 Chaienr ver1.11からの新機能紹介
- イテレーション、ミニバッチ化、伝播処理、パラメータ更新・評価などの訓練プロセスを抽象化するクラスが実装された 
### Dataset
1. 訓練データセットのイテレーション
2. ミニバッチに対する前処理

### Training
- Upadter
3. ニューラルネットワークのForward/backward計算
4. パラメータの更新
- Extenion
5. 評価データセットにおける現在のパラメータの評価
6. 中間結果をログに残す

- Serializerという謎のクラスも実装
  - オブジェクトを直列化、非直列化するためのインターフェースである
  - Numpy, NPZ, HDF5フォーマットをサポートする 


## 3 ChaienrでRNN LSTMで夏目漱石っぽい文章を生成(Deep Soseki)
- 夏目漱石作品を学習させ、夏目漱石っぽい文章を生成するモデルの構築

### 使用しているアルゴリズムの概要
- Recurent Neural Network Language Model
  - 隠れ層をLSTMにしたver
  - http://www.slideshare.net/unnonouno/ss-43844132 15P～19P
  - ちなみに、最近はLSTMの代わりにGRUというものも使われ始めている
  - よくわかるLSTM http://qiita.com/KojiOhki/items/89cd7b69a8a6239d67ca
  


### コード

# Discussion



